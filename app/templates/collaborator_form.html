{% extends "base.html" %}
{% set title = "Colaborador" %}
{% block content %}
<form class="form" method="post">
  <div class="form-row">
    <div>
      <label>ID</label>
      <input name="instructor_id" value="{{ instructor.id if instructor else instructor_id }}" readonly required />
    </div>
    <div>
      <label>Nome Completo</label>
      <input name="nome" id="nome-completo" value="{{ instructor.nome if instructor else '' }}" required />
    </div>
    <div>
      <label>Nome e Sobrenome</label>
      <input name="nome_sobrenome" id="nome-sobrenome" value="{{ instructor.nome_sobrenome if instructor else '' }}" readonly required />
    </div>
    <div>
      <label>Email</label>
      <input name="email" value="{{ instructor.email if instructor else '' }}" required />
    </div>
  </div>
  <div class="form-row">
    <div>
      <label>Telefone</label>
      <input name="telefone" value="{{ instructor.telefone if instructor else '' }}" required />
    </div>
    <div>
      <label>Categoria</label>
      <select name="role">
        {% set role = instructor.role if instructor else 'Instrutor' %}
        <option value="Instrutor" {% if role == "Instrutor" %}selected{% endif %}>Instrutor</option>
        <option value="Analista" {% if role == "Analista" %}selected{% endif %}>Analista</option>
        <option value="Assistente" {% if role == "Assistente" %}selected{% endif %}>Assistente</option>
      </select>
    </div>
    <div>
      <label>Especialidades (use v√≠rgula)</label>
      <input name="especialidades" value="{{ instructor.especialidades | join(', ') if instructor else '' }}" />
    </div>
    <div>
      <label>Limite horas/semana</label>
      <input name="max_horas_semana" value="{{ instructor.max_horas_semana if instructor else '' }}" />
    </div>
    <div>
      <label>Status</label>
      <select name="ativo">
        <option value="true" {% if instructor and instructor.ativo %}selected{% endif %}>Ativo</option>
        <option value="false" {% if instructor and not instructor.ativo %}selected{% endif %}>Inativo</option>
      </select>
    </div>
  </div>
  <div class="actions">
    <button class="button" type="submit">Salvar</button>
    <a class="button ghost" href="/collaborators">Cancelar</a>
  </div>
</form>

<script>
  const nomeCompleto = document.getElementById("nome-completo");
  const nomeSobrenome = document.getElementById("nome-sobrenome");

  function gerarNomeSobrenome() {
    const partes = nomeCompleto.value.trim().split(/\s+/).filter(Boolean);
    if (!partes.length) {
      nomeSobrenome.value = "";
      return;
    }
    if (partes.length === 1) {
      nomeSobrenome.value = partes[0];
      return;
    }
    nomeSobrenome.value = `${partes[0]} ${partes[partes.length - 1]}`;
  }

  nomeCompleto.addEventListener("input", gerarNomeSobrenome);
  if (!nomeSobrenome.value) {
    gerarNomeSobrenome();
  }
</script>
{% endblock %}
